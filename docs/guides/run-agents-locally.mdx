---
title: "Run Agents Locally"
sidebarTitle: "Run Agents Locally"
description: "Set up version-controlled agents in your repository and run them with Continue CLI or GitHub Actions"
---

<Card title="What You'll Build" icon="folder-open">
  A local agent system that:
  - Keeps agent definitions version-controlled alongside your code
  - Runs agents with Continue CLI for local development
  - Automates agent execution on pull requests via GitHub Actions
  - Applies consistent workflows across your team
</Card>

## Why Local Agents?

<CardGroup cols={3}>
  <Card title="Version Control" icon="code-branch">
    Agent definitions evolve with your codebase. Track changes, review in PRs, and roll back when needed.
  </Card>

  <Card title="Team Consistency" icon="users">
    Everyone runs the same agents with the same rules. No configuration drift across machines.
  </Card>

  <Card title="CI/CD Ready" icon="rotate">
    Trigger agents automatically on pull requests, commits, or any GitHub event.
  </Card>
</CardGroup>

## Prerequisites

Before starting, ensure you have:

- [Continue CLI installed](/cli/install) (`npm i -g @continuedev/cli`)
- An LLM API key (e.g., `ANTHROPIC_API_KEY`)
- [GitHub CLI](https://cli.github.com/) if your agents interact with GitHub

## Quick Setup

<Steps>
  <Step title="Create the agents directory">
    ```bash
    mkdir -p .continue/agents
    ```
  </Step>

  <Step title="Create your first agent">
    Create a markdown file with YAML frontmatter defining the agent's behavior:

    ```bash
    touch .continue/agents/my-agent.md
    ```

    Add content like:

    ```markdown
    ---
    name: My First Agent
    description: Describes what this agent does
    tools: built_in
    ---

    You are an agent that helps with [specific task].

    ## Your Task

    1. First, do this
    2. Then, do that
    3. Finally, complete this

    ## Rules

    - Follow this guideline
    - Avoid this pattern
    ```
  </Step>

  <Step title="Run the agent">
    ```bash
    cn --agent .continue/agents/my-agent.md
    ```

    For headless execution (useful for automation):

    ```bash
    cn -p --agent .continue/agents/my-agent.md
    ```
  </Step>
</Steps>

## Agent File Format

Agent files are markdown documents with YAML frontmatter. The frontmatter configures the agent, and the markdown body contains the prompt instructions.

### Frontmatter Options

| Field | Required | Description |
|-------|----------|-------------|
| `name` | Yes | Display name for the agent |
| `description` | Yes | Brief description of what the agent does |
| `tools` | No | Tool configuration (`built_in` for standard tools) |

<Info>
  The markdown body is the agent's system prompt. Write clear, specific instructions with examples for best results.
</Info>

## Example: Conventional PR Title Agent

This agent updates pull request titles to follow conventional commit format:

````markdown
---
name: Conventional Title
description: Updates PR title to follow conventional commit format
tools: built_in
---

You are reviewing a pull request to format its title according to conventional commit standards.

## Your Task

1. **Get the current PR title and number:**
   ```bash
   gh pr view --json number,title -q '{number: .number, title: .title}'
   ```

2. **Get the PR diff to understand changes:**
   ```bash
   git diff origin/main...HEAD --name-only
   ```

3. **Analyze the changes to determine type:**
   - `feat`: New feature
   - `fix`: Bug fix
   - `docs`: Documentation only
   - `refactor`: Code refactoring
   - `chore`: Build, tooling, configs

4. **Update the PR title:**
   ```bash
   gh pr edit PR_NUMBER --title "type: description"
   ```

## Rules

- If title already follows format, do NOT modify
- Keep description under 72 characters
- Use lowercase, no period at end
````

## Security Considerations

<Warning>
  Agents can execute commands and modify files. Review these security practices before deploying to CI/CD.
</Warning>

### Limit Agent Permissions

When running agents in CI/CD, follow the principle of least privilege:

<Tabs>
  <Tab title="GitHub Actions Permissions">
    Only grant the permissions your agent needs:

    ```yaml
    permissions:
      contents: read      # Read repository files
      pull-requests: write # Comment on PRs
      # Avoid: contents: write unless agent needs to push commits
    ```

    <Warning>
      Avoid granting `contents: write` unless your agent specifically needs to push commits. This prevents accidental or malicious code modifications.
    </Warning>
  </Tab>

  <Tab title="CLI Tool Permissions">
    Use `cn` permission flags to restrict what agents can do:

    ```bash
    # Only allow specific tools
    cn --allow "Read()" --allow "Grep()" --exclude "Bash()" \
       --agent .continue/agents/analysis-only.md

    # Always ask before running commands
    cn --ask "Bash(*)" --agent .continue/agents/my-agent.md
    ```

    Learn more in the [CLI documentation](/cli/overview#how-to-set-tool-permissions).
  </Tab>

  <Tab title="Environment Variables">
    Never commit secrets. Use GitHub Actions secrets or environment variables:

    ```yaml
    env:
      ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}
      GH_TOKEN: ${{ github.token }}  # Scoped to the repo
    ```

    <Warning>
      Never hardcode API keys in agent files or workflows. Always use secrets management.
    </Warning>
  </Tab>
</Tabs>

### Review Agent Outputs

Before enabling fully automated agents:

1. **Test locally first** - Run agents with `cn` to verify behavior
2. **Use `--ask` mode** - Require approval for sensitive operations during testing
3. **Review CI logs** - Check what commands agents execute in your workflows
4. **Start with read-only agents** - Begin with agents that analyze rather than modify

<Tip>
  For high-risk operations (like pushing commits or modifying infrastructure), consider requiring manual approval steps in your workflow.
</Tip>

## GitHub Actions Integration

Continue provides a [reusable workflow](https://github.com/continuedev/continue/blob/main/.github/workflows/continue-agents.yml) that handles agent discovery, parallel execution, and GitHub Check reporting.

### Using the Reusable Workflow (Recommended)

Create `.github/workflows/run-agents.yml`:

```yaml
name: Run Agents

on:
  pull_request:
    types: [opened, reopened, synchronize]
    branches:
      - main

jobs:
  agents:
    uses: continuedev/continue/.github/workflows/continue-agents.yml@main
    secrets:
      ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}
```

The reusable workflow automatically:
- Discovers all `.md` files in `.continue/agents/`
- Runs each agent in parallel
- Creates GitHub Check runs for each agent
- Provides `GH_TOKEN` for agents using the `gh` CLI
- Writes job summaries with agent output

### Configuration Options

```yaml
jobs:
  agents:
    uses: continuedev/continue/.github/workflows/continue-agents.yml@main
    with:
      agents-path: '.continue/agents'  # Custom agents directory (optional)
    secrets:
      ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}
```

### Required Secrets

Add this secret to your repository under **Settings > Secrets and variables > Actions**:

| Secret | Description |
|--------|-------------|
| `ANTHROPIC_API_KEY` | Your Anthropic API key for Claude |

<Info>
  The reusable workflow automatically provides `GH_TOKEN` via `${{ github.token }}`, so agents using the `gh` CLI work out of the box.
</Info>

## Environment Variables

When running agents locally that interact with GitHub, set the `GH_TOKEN`:

```bash
# Use your GitHub CLI token
export GH_TOKEN=$(gh auth token)
cn --agent .continue/agents/my-agent.md
```

## Directory Structure

A typical setup looks like:

```
your-repo/
├── .continue/
│   └── agents/
│       ├── conventional-title.md
│       ├── deploy-checklist.md
│       └── security-scan.md
├── .github/
│   └── workflows/
│       └── continue-agents.yml
└── ...
```

## Troubleshooting

<AccordionGroup>
  <Accordion title="Agent not found">
    Ensure the path is correct and the file exists:

    ```bash
    ls -la .continue/agents/
    ```

    The path must be relative to your repository root.
  </Accordion>

  <Accordion title="GitHub CLI authentication errors">
    If agents using `gh` fail, verify authentication:

    ```bash
    # Check auth status
    gh auth status

    # Set token for local testing
    export GH_TOKEN=$(gh auth token)
    ```

    In GitHub Actions, ensure `GH_TOKEN: ${{ github.token }}` is set in the environment.
  </Accordion>

  <Accordion title="Agent runs but doesn't complete the task">
    - Simplify the prompt and add more specific instructions
    - Check if the agent has access to required tools
    - Enable verbose logging: `cn --verbose --agent .continue/agents/my-agent.md`
    - Review logs at `~/.continue/logs/cn.log`
  </Accordion>

  <Accordion title="Workflow doesn't discover agents">
    Verify your agents are in the correct directory:

    ```bash
    find .continue/agents -name "*.md" -type f
    ```

    The workflow looks for `.md` files in `.continue/agents/`.
  </Accordion>
</AccordionGroup>

## Best Practices

<CardGroup cols={2}>
  <Card title="Start Simple" icon="seedling">
    Begin with read-only agents that analyze code before adding agents that make changes.
  </Card>

  <Card title="Test Locally" icon="terminal">
    Always run `cn --agent` locally before enabling CI automation.
  </Card>

  <Card title="Use Descriptive Names" icon="tag">
    Name agent files clearly: `conventional-title.md`, `security-scan.md`, `deploy-checklist.md`.
  </Card>

  <Card title="Keep Agents Focused" icon="bullseye">
    Each agent should do one thing well. Combine multiple agents for complex workflows.
  </Card>
</CardGroup>

## Next Steps

<CardGroup cols={2}>
  <Card title="Agent Overview" icon="robot" href="/agents/overview">
    Learn about agent components and capabilities
  </Card>

  <Card title="CLI Reference" icon="terminal" href="/cli/overview">
    Full Continue CLI documentation
  </Card>

  <Card title="MCP Tools" icon="plug" href="/customize/mcp-tools">
    Add external tools to your agents
  </Card>

  <Card title="Rules" icon="list-check" href="/customize/rules">
    Configure agent behavior with rules
  </Card>
</CardGroup>
